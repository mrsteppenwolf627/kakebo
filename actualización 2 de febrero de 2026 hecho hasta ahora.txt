================================================================================
           KAKEBO AI - DOCUMENTACIÃ“N PARA DUMMIES
           ActualizaciÃ³n: 2 de Febrero de 2026
           Fase 2 Completada: IA Aplicada
================================================================================

Â¿QUÃ‰ ES KAKEBO?
---------------
Kakebo es una aplicaciÃ³n de finanzas personales basada en el mÃ©todo japonÃ©s
del mismo nombre. Te ayuda a controlar tus gastos organizÃ¡ndolos en 4 categorÃ­as:

  â€¢ SURVIVAL (Supervivencia): Comida, transporte, salud - lo que NECESITAS
  â€¢ OPTIONAL (Opcional): Ropa, restaurantes - lo que QUIERES pero no necesitas
  â€¢ CULTURE (Cultura): Libros, cursos, cine - ocio y desarrollo personal
  â€¢ EXTRA: Gastos inesperados y excepcionales

La app te permite registrar gastos, ver cuÃ¡nto llevas gastado cada mes,
y establecer presupuestos para no pasarte.


================================================================================
                    Â¿QUÃ‰ HEMOS CONSTRUIDO? (Fase 1)
================================================================================

Imagina una app como un restaurante:
- El FRONTEND es el comedor (lo que ves: menÃºs, mesas, decoraciÃ³n)
- El BACKEND es la cocina (donde se prepara todo, tÃº no lo ves pero es esencial)

En la Fase 1 hemos construido toda la "cocina" profesional.


--------------------------------------------------------------------------------
1. API REST - El MenÃº del Restaurante
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Una API es como el menÃº de un restaurante. Define quÃ© "platos" (operaciones)
puedes pedir y cÃ³mo pedirlos.

REST es un estilo de organizaciÃ³n. Es como decir "los entrantes van primero,
luego los principales, luego los postres".

Â¿QuÃ© endpoints (platos) tenemos?

  GASTOS VARIABLES (/api/expenses)
  --------------------------------
  GET    /api/expenses         â†’ Ver todos tus gastos
  GET    /api/expenses?ym=2026-01  â†’ Ver gastos de enero 2026
  POST   /api/expenses         â†’ Crear un nuevo gasto
  GET    /api/expenses/123     â†’ Ver un gasto especÃ­fico
  PATCH  /api/expenses/123     â†’ Modificar un gasto
  DELETE /api/expenses/123     â†’ Eliminar un gasto

  GASTOS FIJOS (/api/fixed-expenses)
  ----------------------------------
  Son gastos que se repiten cada mes: alquiler, Netflix, gimnasio...

  GET    /api/fixed-expenses   â†’ Ver todos tus gastos fijos
  POST   /api/fixed-expenses   â†’ Crear un gasto fijo (ej: "Netflix, 15.99â‚¬/mes")
  PATCH  /api/fixed-expenses/123 â†’ Modificar (ej: subiÃ³ a 17.99â‚¬)
  DELETE /api/fixed-expenses/123 â†’ Cancelar suscripciÃ³n

  MESES (/api/months)
  -------------------
  Cada mes es un "perÃ­odo contable". Puedes cerrarlo cuando acabe.

  GET    /api/months           â†’ Ver todos tus meses
  POST   /api/months           â†’ Crear/obtener un mes (ej: enero 2026)
  PATCH  /api/months/123       â†’ Cerrar un mes (ya no puedes aÃ±adir gastos)

  CONFIGURACIÃ“N (/api/settings)
  -----------------------------
  Tu configuraciÃ³n personal: ingresos, presupuestos por categorÃ­a...

  GET    /api/settings         â†’ Ver tu configuraciÃ³n
  PATCH  /api/settings         â†’ Cambiar configuraciÃ³n

  DOCUMENTACIÃ“N (/api/docs)
  -------------------------
  GET    /api/docs             â†’ Ver la documentaciÃ³n tÃ©cnica de la API


--------------------------------------------------------------------------------
2. VALIDACIÃ“N CON ZOD - El Control de Calidad
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Zod es como un guardia de seguridad que revisa todo lo que entra.

Ejemplo sin Zod (peligroso):
  Usuario envÃ­a: { amount: "hola", date: "ayer" }
  La app explota ğŸ’¥

Ejemplo con Zod (seguro):
  Usuario envÃ­a: { amount: "hola", date: "ayer" }
  Zod responde: "Error: amount debe ser un nÃºmero, date debe ser YYYY-MM-DD"
  La app sigue funcionando âœ…

Â¿DÃ³nde estÃ¡?
  src/lib/schemas/common.ts      â†’ Validaciones comunes (fechas, UUIDs, etc)
  src/lib/schemas/expense.ts     â†’ ValidaciÃ³n de gastos
  src/lib/schemas/month.ts       â†’ ValidaciÃ³n de meses
  src/lib/schemas/settings.ts    â†’ ValidaciÃ³n de configuraciÃ³n
  src/lib/schemas/fixed-expense.ts â†’ ValidaciÃ³n de gastos fijos


--------------------------------------------------------------------------------
3. AUTENTICACIÃ“N - El Portero del Club
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Verifica que eres quien dices ser antes de dejarte hacer cualquier cosa.

Â¿CÃ³mo funciona?
1. Te registras/logueas con Supabase Auth (email, Google, etc.)
2. Recibes un "token" (como una pulsera de discoteca)
3. Cada vez que pides algo, muestras tu pulsera
4. Si no tienes pulsera vÃ¡lida â†’ Error 401 "No autorizado"

Â¿DÃ³nde estÃ¡?
  src/lib/api/auth.ts â†’ FunciÃ³n requireAuth() que verifica tu sesiÃ³n

AdemÃ¡s, cada usuario SOLO ve sus propios datos. Si tÃº tienes gastos y yo
tengo gastos, tÃº no puedes ver los mÃ­os ni yo los tuyos.


--------------------------------------------------------------------------------
4. MANEJO DE ERRORES - El Protocolo de Emergencias
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Cuando algo sale mal, en vez de que la app explote, devuelve un mensaje
claro explicando quÃ© pasÃ³.

Tipos de errores que manejamos:

  400 Bad Request      â†’ "Lo que enviaste no tiene sentido"
  401 Unauthorized     â†’ "No has iniciado sesiÃ³n"
  403 Forbidden        â†’ "No tienes permiso para esto"
  404 Not Found        â†’ "Eso que buscas no existe"
  409 Conflict         â†’ "No puedes hacer eso (ej: mes cerrado)"
  422 Validation Error â†’ "Los datos no son vÃ¡lidos"
  500 Internal Error   â†’ "Algo fallÃ³ por nuestra parte"

Ejemplo de respuesta de error:
  {
    "success": false,
    "error": {
      "code": "VALIDATION_ERROR",
      "message": "Error de validaciÃ³n en 'amount': debe ser mayor que 0",
      "details": { "amount": ["debe ser mayor que 0"] }
    }
  }

Â¿DÃ³nde estÃ¡?
  src/lib/api/errors.ts    â†’ Clases de error y funciÃ³n handleApiError()
  src/lib/api/responses.ts â†’ Respuestas estandarizadas (ok, created, etc.)


--------------------------------------------------------------------------------
5. LOGGING - La Caja Negra del AviÃ³n
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Registro de todo lo que pasa en la aplicaciÃ³n. Si algo falla, podemos
ver el "historial" para entender quÃ© pasÃ³.

Â¿QuÃ© registramos?
  â€¢ Cada peticiÃ³n que llega (quiÃ©n, quÃ© pidiÃ³, cuÃ¡ndo)
  â€¢ Cada respuesta que sale (cÃ³digo de estado, cuÃ¡nto tardÃ³)
  â€¢ Todos los errores (con detalle completo)

Ejemplo de log:
  [12:30:45] INFO: POST /api/expenses (user: abc123)
  [12:30:45] INFO: POST /api/expenses -> 201 (45ms)

Â¿Por quÃ© es importante?
  â€¢ En desarrollo: ver quÃ© estÃ¡ pasando en tiempo real
  â€¢ En producciÃ³n: diagnosticar problemas sin acceso directo al servidor
  â€¢ MÃ©tricas: detectar endpoints lentos, errores frecuentes, etc.

Â¿DÃ³nde estÃ¡?
  src/lib/logger.ts         â†’ ConfiguraciÃ³n de pino (la librerÃ­a de logging)
  src/lib/api/withLogging.ts â†’ Middleware que envuelve cada endpoint


--------------------------------------------------------------------------------
6. TESTS - El Control de Calidad AutomÃ¡tico
--------------------------------------------------------------------------------

Â¿QuÃ© son?
Programas que verifican automÃ¡ticamente que todo funciona bien.
Es como tener un empleado que prueba cada funciÃ³n 1000 veces al dÃ­a.

Â¿CuÃ¡ntos tests tenemos?
  138 tests en total, distribuidos asÃ­:

  Tests de Schemas (validaciÃ³n):
    â€¢ expense.test.ts      â†’ 13 tests
    â€¢ fixed-expense.test.ts â†’ 18 tests
    â€¢ month.test.ts        â†’ 20 tests
    â€¢ settings.test.ts     â†’ 10 tests

  Tests de API (endpoints):
    â€¢ expenses.test.ts     â†’ 8 tests
    â€¢ fixed-expenses.test.ts â†’ 8 tests
    â€¢ months.test.ts       â†’ 6 tests
    â€¢ settings.test.ts     â†’ 6 tests

  Tests de utilidades:
    â€¢ errors.test.ts       â†’ 23 tests
    â€¢ responses.test.ts    â†’ 17 tests
    â€¢ logger.test.ts       â†’ 9 tests

Â¿QuÃ© es el "coverage"?
  Mide quÃ© porcentaje del cÃ³digo estÃ¡ siendo probado.

  Nuestros nÃºmeros:
    â€¢ Statements: 91% (lÃ­neas de cÃ³digo ejecutadas)
    â€¢ Branches: 84% (caminos if/else probados)
    â€¢ Functions: 97% (funciones llamadas)
    â€¢ Lines: 94% (similar a statements)

  El estÃ¡ndar de industria es 80%. Nosotros lo superamos âœ…

Â¿CÃ³mo ejecutar los tests?
  npm test              â†’ Ejecutar todos los tests
  npm test -- --coverage â†’ Ver el reporte de coverage

Â¿DÃ³nde estÃ¡n?
  src/__tests__/           â†’ Carpeta con todos los tests
  vitest.config.ts         â†’ ConfiguraciÃ³n del test runner


--------------------------------------------------------------------------------
7. DOCUMENTACIÃ“N OPENAPI - El Manual de Instrucciones
--------------------------------------------------------------------------------

Â¿QuÃ© es?
OpenAPI (antes Swagger) es un estÃ¡ndar para documentar APIs.
Es como el manual de instrucciones de un electrodomÃ©stico.

Â¿QuÃ© incluye nuestra documentaciÃ³n?
  â€¢ Todos los endpoints disponibles
  â€¢ QuÃ© parÃ¡metros acepta cada uno
  â€¢ QuÃ© formato debe tener el body
  â€¢ QuÃ© respuestas puede devolver
  â€¢ Ejemplos de uso

Â¿CÃ³mo acceder?
  GET http://localhost:3000/api/docs

  Devuelve un JSON que puedes importar en:
    â€¢ Postman (para probar la API)
    â€¢ Swagger UI (para ver documentaciÃ³n bonita)
    â€¢ Insomnia (alternativa a Postman)

Â¿DÃ³nde estÃ¡?
  src/lib/api/openapi.ts   â†’ La especificaciÃ³n completa
  src/app/api/docs/route.ts â†’ El endpoint que la sirve


================================================================================
                    Â¿QUÃ‰ HEMOS CONSTRUIDO? (Fase 2) - COMPLETADA
================================================================================

En la Fase 2 hemos aÃ±adido la "inteligencia" a la aplicaciÃ³n.


--------------------------------------------------------------------------------
1. CLASIFICADOR DE GASTOS CON IA
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Un sistema que usa GPT-4o-mini para clasificar automÃ¡ticamente tus gastos
en las 4 categorÃ­as Kakebo.

Â¿CÃ³mo funciona?
1. Escribes "Netflix mensual"
2. La IA analiza el texto
3. Devuelve: { category: "culture", note: "SuscripciÃ³n streaming", confidence: 0.95 }

Endpoint:
  POST /api/ai/classify
  Body: { "text": "Netflix mensual" }

Archivos:
  src/lib/ai/classifier.ts  â†’ LÃ³gica de clasificaciÃ³n
  src/lib/ai/prompts.ts     â†’ Prompts versionados (v1, v2)
  src/lib/ai/client.ts      â†’ Cliente OpenAI


--------------------------------------------------------------------------------
2. ASISTENTE CONVERSACIONAL CON FUNCTION CALLING
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Un chat que no solo responde, sino que HACE cosas. Puede crear gastos,
consultar tu saldo, cambiar tu presupuesto...

Ejemplos:
  "AÃ±ade 45â‚¬ de Mercadona"       â†’ Crea el gasto automÃ¡ticamente
  "Â¿CuÃ¡nto llevo gastado?"       â†’ Consulta y te responde
  "Pon mi presupuesto en 200â‚¬"   â†’ Actualiza tu configuraciÃ³n

Herramientas disponibles:
  â€¢ create_expense: Crear gasto
  â€¢ list_expenses: Listar gastos
  â€¢ get_monthly_summary: Resumen del mes
  â€¢ get_settings: Ver configuraciÃ³n
  â€¢ update_settings: Cambiar configuraciÃ³n
  â€¢ classify_expense: Clasificar texto

Endpoint:
  POST /api/ai/assistant
  Body: { "message": "AÃ±ade 30â‚¬ de gasolina" }

Archivos:
  src/lib/ai/assistant.ts      â†’ Asistente conversacional
  src/lib/ai/tools.ts          â†’ Definiciones de funciones
  src/lib/ai/tool-executor.ts  â†’ Ejecutor de funciones


--------------------------------------------------------------------------------
3. SISTEMA DE MÃ‰TRICAS DE IA
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Un sistema que registra CADA uso de la IA para poder analizar:
  â€¢ Â¿CuÃ¡ntas clasificaciones hacemos?
  â€¢ Â¿CuÃ¡nto cuesta?
  â€¢ Â¿CuÃ¡nto tarda?
  â€¢ Â¿QuÃ© tan precisa es?

Tabla en Supabase: ai_logs
  â€¢ user_id, type (classification/assistant)
  â€¢ input, output, model, prompt_version
  â€¢ input_tokens, output_tokens, cost_usd, latency_ms
  â€¢ success, error_message
  â€¢ was_corrected, corrected_category

Endpoint de mÃ©tricas:
  GET /api/ai/metrics?includeLogs=true

Respuesta:
  {
    "metrics": {
      "totalRequests": 150,
      "successRate": 98.5,
      "totalCostUsd": 0.0234,
      "avgLatencyMs": 450,
      "classificationAccuracy": 94,
      ...
    },
    "logs": [...]
  }

Archivos:
  src/lib/ai/metrics.ts         â†’ Funciones de logging y mÃ©tricas
  src/app/api/ai/metrics/route.ts â†’ Endpoint GET


--------------------------------------------------------------------------------
4. PANEL DE MÃ‰TRICAS IA (NUEVO - 2 Feb 2026)
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Un dashboard visual para ver todas las mÃ©tricas de IA en un solo lugar.
Accesible desde /app/ai-metrics

CaracterÃ­sticas:
  â€¢ Filtro por rango de fechas (7d, 30d, 90d, todo)
  â€¢ Cards con mÃ©tricas clave:
    - Total peticiones
    - Tasa de Ã©xito (%)
    - Costo total ($)
    - Latencia media (ms)
    - Accuracy (% de clasificaciones correctas)
  â€¢ Uso de tokens (entrada, salida, total, costo/peticiÃ³n)
  â€¢ GrÃ¡ficos de distribuciÃ³n:
    - Por tipo (clasificaciÃ³n vs asistente)
    - Por modelo (gpt-4o-mini, etc.)
  â€¢ Lista de logs recientes con estado de correcciÃ³n

NavegaciÃ³n:
  Se aÃ±adiÃ³ enlace "IA" en la barra de navegaciÃ³n superior

Archivos:
  src/app/app/ai-metrics/page.tsx         â†’ PÃ¡gina principal
  src/app/app/ai-metrics/AIMetricsClient.tsx â†’ Componente cliente
  src/components/AIMetricsChart.tsx       â†’ GrÃ¡ficos (bar/pie)
  src/components/AILogsList.tsx           â†’ Lista de logs
  src/components/TopNav.tsx               â†’ Enlace aÃ±adido


--------------------------------------------------------------------------------
5. FEEDBACK LOOP - CORRECCIÃ“N DE CLASIFICACIONES (NUEVO - 2 Feb 2026)
--------------------------------------------------------------------------------

Â¿QuÃ© es?
Un sistema para que cuando la IA se equivoque, tÃº puedas corregirla.
Esto mejora el accuracy medido y prepara datos para futuro fine-tuning.

Â¿CÃ³mo funciona?

1. En /app/new (crear nuevo gasto):
   - Escribes el concepto (ej: "Netflix mensual")
   - Haces click en el botÃ³n "ğŸ¤– IA"
   - La IA sugiere una categorÃ­a con % de confianza

2. Puedes:
   - ACEPTAR: Se selecciona la categorÃ­a sugerida
   - IGNORAR: Se descarta la sugerencia
   - CAMBIAR: Eliges otra categorÃ­a manualmente

3. Al guardar el gasto:
   - Si aceptaste la sugerencia â†’ No se registra correcciÃ³n
   - Si elegiste otra categorÃ­a â†’ Se registra correcciÃ³n automÃ¡ticamente

4. En /app/ai-metrics:
   - Ves cuÃ¡ntas correcciones has hecho
   - Ves el accuracy real (clasificaciones correctas / total)

Endpoint de feedback:
  POST /api/ai/feedback
  Body: { "logId": "uuid-del-log", "correctedCategory": "supervivencia" }

El classify ahora devuelve logId:
  POST /api/ai/classify â†’ { ..., "logId": "uuid" }

Archivos:
  src/app/api/ai/feedback/route.ts    â†’ Endpoint de correcciÃ³n
  src/app/api/ai/classify/route.ts    â†’ Modificado para devolver logId
  src/app/app/new/NewExpenseClient.tsx â†’ UI de sugerencia IA
  src/lib/schemas/ai.ts               â†’ feedbackRequestSchema


================================================================================
                         ESTRUCTURA DE CARPETAS ACTUALIZADA
================================================================================

kakebo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ ai/                    â† ENDPOINTS DE IA (Fase 2)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ classify/          â† POST - Clasificar gasto
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ assistant/         â† POST - Chat con IA
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ feedback/          â† POST - Registrar correcciÃ³n (NUEVO)
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ metrics/           â† GET - MÃ©tricas agregadas
â”‚   â”‚   â”‚   â”œâ”€â”€ docs/                  â† DocumentaciÃ³n OpenAPI
â”‚   â”‚   â”‚   â”œâ”€â”€ expenses/              â† CRUD de gastos
â”‚   â”‚   â”‚   â”œâ”€â”€ fixed-expenses/        â† CRUD de gastos fijos
â”‚   â”‚   â”‚   â”œâ”€â”€ months/                â† CRUD de meses
â”‚   â”‚   â”‚   â”œâ”€â”€ settings/              â† ConfiguraciÃ³n usuario
â”‚   â”‚   â”‚   â””â”€â”€ health/                â† Health check
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ app/
â”‚   â”‚       â”œâ”€â”€ ai-metrics/            â† DASHBOARD IA (NUEVO)
â”‚   â”‚       â”‚   â”œâ”€â”€ page.tsx           â† PÃ¡gina con Suspense
â”‚   â”‚       â”‚   â””â”€â”€ AIMetricsClient.tsx â† Cliente con grÃ¡ficos
â”‚   â”‚       â”œâ”€â”€ new/
â”‚   â”‚       â”‚   â””â”€â”€ NewExpenseClient.tsx â† Con sugerencia IA (MODIFICADO)
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ AIMetricsChart.tsx         â† GrÃ¡ficos bar/pie (NUEVO)
â”‚   â”‚   â”œâ”€â”€ AILogsList.tsx             â† Lista de logs (NUEVO)
â”‚   â”‚   â”œâ”€â”€ TopNav.tsx                 â† Con enlace a IA (MODIFICADO)
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ ai/                        â† MÃ“DULO DE IA
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts              â† Cliente OpenAI
â”‚   â”‚   â”‚   â”œâ”€â”€ prompts.ts             â† Prompts versionados
â”‚   â”‚   â”‚   â”œâ”€â”€ classifier.ts          â† Clasificador
â”‚   â”‚   â”‚   â”œâ”€â”€ assistant.ts           â† Asistente conversacional
â”‚   â”‚   â”‚   â”œâ”€â”€ tools.ts               â† Definiciones de funciones
â”‚   â”‚   â”‚   â”œâ”€â”€ tool-executor.ts       â† Ejecutor de funciones
â”‚   â”‚   â”‚   â”œâ”€â”€ metrics.ts             â† Logging y mÃ©tricas
â”‚   â”‚   â”‚   â””â”€â”€ index.ts               â† Re-exportaciones
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ api/                       â† Utilidades de API
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ schemas/                   â† ValidaciÃ³n con Zod
â”‚   â”‚       â”œâ”€â”€ ai.ts                  â† Schemas de IA (MODIFICADO)
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ __tests__/                     â† Tests
â”‚       â””â”€â”€ ...
â”‚
â””â”€â”€ .ai/                               â† Contexto del proyecto
    â”œâ”€â”€ CONTEXT.md                     â† Estado global (ACTUALIZADO)
    â””â”€â”€ CURRENT_TASK.md                â† Tarea actual (ACTUALIZADO)


================================================================================
                           TECNOLOGÃAS USADAS
================================================================================

FRAMEWORK
  â€¢ Next.js 14 (App Router) - Framework de React para web apps
  â€¢ TypeScript - JavaScript con tipos (menos errores)

BASE DE DATOS
  â€¢ Supabase - PostgreSQL en la nube + autenticaciÃ³n incluida
  â€¢ Tabla ai_logs - Para mÃ©tricas de IA

VALIDACIÃ“N
  â€¢ Zod - ValidaciÃ³n de datos con inferencia de tipos

TESTING
  â€¢ Vitest - Test runner rÃ¡pido (compatible con Jest)
  â€¢ @testing-library - Utilidades para tests

LOGGING
  â€¢ Pino - Logger de alto rendimiento para Node.js
  â€¢ pino-pretty - Formato legible para desarrollo

DOCUMENTACIÃ“N
  â€¢ OpenAPI 3.0 - EstÃ¡ndar de documentaciÃ³n de APIs

IA / MACHINE LEARNING
  â€¢ OpenAI API - GPT-4o-mini para clasificaciÃ³n y chat
  â€¢ Function Calling - Para que la IA ejecute acciones

GRÃFICOS
  â€¢ Recharts - LibrerÃ­a de grÃ¡ficos para React


================================================================================
                         COMANDOS ÃšTILES
================================================================================

# Instalar dependencias
npm install

# Ejecutar en desarrollo
npm run dev

# Ejecutar tests
npm test

# Ver coverage de tests
npm test -- --coverage

# Verificar tipos de TypeScript
npx tsc --noEmit

# Compilar para producciÃ³n
npm run build

# Ver documentaciÃ³n de la API
# (con el servidor corriendo)
curl http://localhost:3000/api/docs


================================================================================
                         ENDPOINTS DE IA DISPONIBLES
================================================================================

| MÃ©todo | Ruta                | DescripciÃ³n                          |
|--------|---------------------|--------------------------------------|
| POST   | /api/ai/classify    | Clasificar gasto (devuelve logId)    |
| POST   | /api/ai/assistant   | Chat con IA (function calling)       |
| POST   | /api/ai/feedback    | Registrar correcciÃ³n de clasificaciÃ³n|
| GET    | /api/ai/metrics     | MÃ©tricas agregadas + logs opcionales |


================================================================================
                         Â¿QUÃ‰ SIGUE? (Fase 3 - RAG y Memoria)
================================================================================

  â€¢ Vector Database
    â†’ Habilitar pgvector en Supabase para bÃºsqueda semÃ¡ntica

  â€¢ Embeddings
    â†’ Generar embeddings de gastos con text-embedding-3-small

  â€¢ BÃºsqueda SemÃ¡ntica
    â†’ Encontrar gastos similares en el historial

  â€¢ Asistente Contextual
    â†’ El chat "recuerda" tus gastos anteriores para dar mejor contexto

  â€¢ MÃ©tricas RAG
    â†’ Medir calidad del retrieval


================================================================================
                              FIN
================================================================================

Documento creado: 1 de Febrero de 2026
Ãšltima actualizaciÃ³n: 2 de Febrero de 2026
Autor: Claude Opus 4.5 + Aitor
VersiÃ³n: 2.0 - Fase 1 + Fase 2 COMPLETADAS
