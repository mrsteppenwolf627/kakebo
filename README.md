<div align="center">

<img src="https://img.shields.io/badge/Kakebo-FF6B6B?style=for-the-badge&logo=openai&logoColor=white" alt="Kakebo" />

# ğŸ® Kakebo

### *Finanzas personales con mÃ©todo japonÃ©s e Inteligencia Artificial*

<p align="center">
  <img src="https://img.shields.io/badge/Next.js-14-black?style=flat-square&logo=next.js" alt="Next.js" />
  <img src="https://img.shields.io/badge/TypeScript-5.0-blue?style=flat-square&logo=typescript" alt="TypeScript" />
  <img src="https://img.shields.io/badge/OpenAI-GPT--4o--mini-412991?style=flat-square&logo=openai" alt="OpenAI" />
  <img src="https://img.shields.io/badge/Supabase-PostgreSQL-3ECF8E?style=flat-square&logo=supabase" alt="Supabase" />
  <img src="https://img.shields.io/badge/License-Proprietary-red?style=flat-square" alt="License" />
</p>

<p align="center">
  <a href="#-caracterÃ­sticas"><strong>CaracterÃ­sticas</strong></a> Â·
  <a href="#-quick-start"><strong>Quick Start</strong></a> Â·
  <a href="#-documentaciÃ³n"><strong>Docs</strong></a> Â·
  <a href="#-freemium-model"><strong>Pricing</strong></a>
</p>

</div>

---

## ğŸŒ¸ Â¿QuÃ© es Kakebo?

**Kakebo** es una aplicaciÃ³n moderna de gestiÃ³n financiera que digitaliza el mÃ©todo tradicional japonÃ©s de ahorro. Combina la filosofÃ­a del "ahorro consciente" con un **Copiloto Financiero IA** que te ayuda a registrar, entender y optimizar tus gastos sin esfuerzo.

A diferencia de un Excel o una app bancaria, Kakebo:

- ğŸ§  **Es Proactivo**: Tu copiloto sugiere presupuestos, detecta anomalÃ­as y proyecta tu ahorro.
- ğŸ’¬ **Es Conversacional**: Registra gastos ("CafÃ© 2â‚¬") o consulta datos ("Â¿CuÃ¡nto gastÃ© en ocio?") por chat.
- ğŸ¯ **Es MetÃ³dico**: Se basa en las 4 categorÃ­as Kakebo (Supervivencia, Opcional, Cultura, Extra) para dar sentido a tu dinero.
- ğŸŒ **Es Privado**: Tus datos son tuyos. El sistema aprende patrones globales sin exponer tu informaciÃ³n.

---

## âœ¨ CaracterÃ­sticas

### ğŸ¤– Kakebo Copilot (v3)

<details>
<summary><b>Tu Asistente Financiero Personal</b></summary>

**El Copilot no solo responde, Â¡ACTÃšA!** Gestiona tus finanzas conversacionalmente:

```
ğŸ‘¤ "Registra 50â‚¬ de comida"
ğŸ¤– "Â¿Quieres que registre un gasto de 50â‚¬ en supervivencia con concepto 'comida'?"
ğŸ‘¤ "SÃ­"
ğŸ¤– "âœ… Registrado: Gasto de 50â‚¬ en supervivencia - 'comida'"

ğŸ‘¤ "Cambia el Ãºltimo gasto a 45â‚¬"
ğŸ¤– "Â¿Cambio el importe de 50â‚¬ a 45â‚¬?"
ğŸ‘¤ "SÃ­"
ğŸ¤– "âœ… Actualizado: importe modificado"

ğŸ‘¤ "Quiero ahorrar 1200â‚¬ para vacaciones en agosto"
ğŸ¤– "Â¿Confirmas escenario 'Vacaciones Agosto' (1200â‚¬, categorÃ­a opcional)?"
ğŸ‘¤ "SÃ­"
ğŸ¤– "âœ… Escenario creado. Necesitas ahorrar 200â‚¬/mes durante 6 meses"
```

**Powered by GPT-4o-mini con Function Calling + 12 herramientas especializadas**

</details>

### ğŸ’° GestiÃ³n Financiera Avanzada

- âœ… **MÃ©todo Kakebo Digital**: ClasificaciÃ³n automÃ¡tica en Supervivencia, Opcional, Cultura, Extra.
- ğŸ“… **Calendario Inteligente**: Vista mensual con estados (Abierto/Cerrado) y desglose de dÃ­as restantes.
- ğŸ’¸ **GestiÃ³n de Ingresos Flexible**: Soporte para nÃ³minas, extras y regalos con cÃ¡lculo de "Dinero Realmente Disponible".
- ğŸ¯ **Presupuestos DinÃ¡micos**: Configura lÃ­mites por categorÃ­a y recibe alertas visuales.
- ğŸ’³ **Registro Dual**: AÃ±ade gastos vÃ­a Chat (Copilot) o interfaz rÃ¡pida (Quick Add).
- ğŸ² **Escenarios What-If**: Planifica gastos futuros y ve cÃ³mo afectan a tu ahorro.
- ğŸ”„ **Embeddings AutomÃ¡ticos**: Sistema de bÃºsqueda semÃ¡ntica que aprende automÃ¡ticamente cada 5 gastos (global).

### ğŸ“„ Reportes & AnÃ¡lisis

- ğŸ“‘ **Reportes PDF**: Genera informes mensuales detallados para guardar o imprimir.
- ğŸ“Š **AnÃ¡lisis Visual**: GrÃ¡ficos de distribuciÃ³n (Donut) y evoluciÃ³n (Barras).
- ğŸ’¾ **ExportaciÃ³n**: Tus datos siempre disponibles.

### ğŸ¨ DiseÃ±o Zen (Wabi-Sabi)

- ğŸŒ¸ Interfaz minimalista que reduce la ansiedad financiera.
- ğŸŒ“ **Modo Oscuro** automÃ¡tico y cuidado.
- ğŸŒ“ **Modo Oscuro** automÃ¡tico y cuidado.
- ğŸ“± **Totalmente Responsive** (PWA-ready).

### ğŸ› ï¸ Herramientas Gratuitas (SEO Magnets)
- ğŸ“‰ **Calculadora de InflaciÃ³n**: Visualiza la pÃ©rdida de poder adquisitivo de tus ahorros.
- ğŸ° **Regla 50/30/20**: Distribuye tu sueldo idealmente entre necesidades, caprichos y ahorro.
- ğŸ•µï¸ **Analytics Privado**: Sistema de tracking propio sin cookies invasivas.

---

## ğŸš€ Quick Start

### Prerrequisitos

```bash
Node.js â‰¥ 18.0.0
npm â‰¥ 9.0.0
```

### InstalaciÃ³n en 3 pasos

```bash
# 1. Clonar el repositorio
git clone https://github.com/mrsteppenwolf627/kakebo.git
cd kakebo

# 2. Instalar dependencias
npm install

# 3. Configurar variables de entorno
cp .env.example .env.local
# Edita .env.local con tus keys (ver abajo)

# 4. Ejecutar en desarrollo
npm run dev
```

Abre [http://localhost:3000](http://localhost:3000) ğŸ‰

### âš™ï¸ Variables de Entorno

Crea `.env.local` con:

```env
# Supabase (Database + Auth)
NEXT_PUBLIC_SUPABASE_URL=https://tu-proyecto.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=tu_anon_key
SUPABASE_SERVICE_ROLE_KEY=tu_service_role_key

# OpenAI (AI Copilot)
OPENAI_API_KEY=sk-proj-...

# Stripe (Suscripciones)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PRICE_ID_PRO=price_...
STRIPE_WEBHOOK_SECRET=whsec_...
NEXT_PUBLIC_PRICE_DISPLAY=3.99â‚¬

# Admin & Config
NEXT_PUBLIC_ADMIN_EMAILS=tu-email@ejemplo.com
NEXT_PUBLIC_APP_URL=http://localhost:3000 # O tu dominio en prod
USE_FUNCTION_CALLING_AGENT=true
```

---

## ğŸ’ Modelo de SuscripciÃ³n (SaaS)

### ğŸ 14 DÃ­as Premium Gratis
**Todo incluido al registrarte. Sin tarjeta de crÃ©dito.**

Disfruta de la experiencia completa de Kakebo durante 14 dÃ­as:
- ğŸ¤– **Copilot Ilimitado**: Chat y acciones automÃ¡ticas
- ğŸ“Š **HistÃ³rico Completo**: Acceso a meses anteriores
- ğŸ“„ **Reportes PDF**: Descarga tus balances

### ğŸ”’ DespuÃ©s del Trial â€” **â‚¬3.99/mes**
Si decides continuar con la ayuda de la IA:
- MantÃ©n acceso a todas las funcionalidades Premium
- Cancela cuando quieras

*Si no te suscribes, tu cuenta pasa a modo "Manual BÃ¡sico" (solo registro manual limitado, sin histÃ³rico antiguo ni IA).*

---

## ğŸ› ï¸ Tech Stack

<table>
<tr>
<td valign="top" width="50%">

### Frontend

- âš¡ **Next.js 14** (App Router)
- âš›ï¸ **React 18**
- ğŸ”· **TypeScript**
- ğŸ¨ **Tailwind CSS**
- ğŸ“Š **Recharts**
- ğŸ“„ **React-PDF Renderer**
- ğŸŒ **next-intl** (i18n)

</td>
<td valign="top" width="50%">

### Backend

- ğŸŸ¢ **Next.js API Routes**
- ğŸ˜ **PostgreSQL** (Supabase)
- ğŸ” **Supabase Auth**
- ğŸ’³ **Stripe** (pagos)
- ğŸ§  **OpenAI API** (GPT-4o-mini)
- ğŸ” **pgvector** (embeddings)

</td>
</tr>
</table>

### ğŸ¤– AI Architecture (v3 - Copilot)

- **Model**: GPT-4o-mini con Function Calling
- **Agent Type**: Proactive Copilot
- **Tools**: 12 herramientas especializadas (Lectura + Escritura)
- **Memory**: PostgreSQL + pgvector para bÃºsqueda semÃ¡ntica y aprendizaje.
- **Safety**: ConfirmaciÃ³n explÃ­cita para acciones crÃ­ticas (Write operations).

---

## ğŸ“– DocumentaciÃ³n

### ğŸ“š GuÃ­as Principales

- [ğŸ“˜ Arquitectura del Sistema](CONTEXT.md) - Overview completo
- [ğŸš€ Deployment Guide](docs/DEPLOYMENT_GUIDE.md) - Deploy a producciÃ³n
- [ğŸ§ª Testing Guide](docs/MANUAL_TESTING_GUIDE.md) - Testing manual

### ğŸ¤– Kakebo Copilot Internals

- [ğŸ› ï¸ GuÃ­a de ImplementaciÃ³n](KAKEBO_COPILOT_IMPLEMENTATION.md) - Arquitectura Copilot
- [ğŸ§  AI Agent Architecture](docs/KAKEBOT_V2_ARCHITECTURE.md) - CÃ³mo funciona el agente
- [ğŸ“¡ API Documentation](docs/API_DOCUMENTATION.md) - Endpoints y ejemplos

---

## ğŸ“ Changelog Reciente

### v3.8.0 (2026-02-19) - AI Accuracy & Safety Improvements ğŸ§ ğŸ›¡ï¸

**AI Learning & Accuracy:**
- ğŸ§  **Merchant Map & Learned Rules (P1-1)**: El sistema ahora aprende automÃ¡ticamente de tus correcciones de categorÃ­a. Si cambias "Mercadona" de opcional a supervivencia, futuras compras usarÃ¡n la categorÃ­a correcta. Sistema de reglas personales (priorizadas) y globales (consenso de usuarios).
- ğŸ“š **Correction Examples (P1-2)**: Almacenamiento de ejemplos completos de correcciones para few-shot learning con GPT. El AI aprende del contexto completo (concepto, importe, fecha) para mejorar clasificaciones futuras.
- ğŸ¯ **GPT Integration**: IntegraciÃ³n automÃ¡tica de ejemplos de correcciÃ³n en el clasificador GPT. El sistema ahora muestra al AI tus correcciones pasadas para evitar errores repetidos. ReducciÃ³n esperada del 20-30% en tasa de correcciones.

**Safety & Validation:**
- ğŸ›¡ï¸ **Write Confirmation (P0-1)**: ConfirmaciÃ³n explÃ­cita para operaciones de escritura (crear/actualizar/eliminar gastos) para prevenir cambios accidentales por el AI.
- âœ… **Pre-write Validation (P0-2)**: ValidaciÃ³n automÃ¡tica antes de crear transacciones:
  - ValidaciÃ³n de importes (>0, <â‚¬10,000)
  - ValidaciÃ³n de fechas (mÃ¡x 7 dÃ­as futuro, alerta >1 aÃ±o pasado)
  - ValidaciÃ³n de conceptos (mÃ­n 3 caracteres, alerta tÃ©rminos ambiguos)
  - DetecciÃ³n de duplicados (ventana 24h)

**Technical Details:**
- ğŸ“Š **124 tests** implementados (todos pasando): 13 P0-1 + 24 P0-2 + 59 P1-1 + 21 P1-2 + 7 GPT Integration
- ğŸ—„ï¸ **2 nuevas tablas**: `merchant_rules` (reglas aprendidas) y `correction_examples` (ejemplos para GPT)
- ğŸ”„ **Aprendizaje automÃ¡tico**: Cada correcciÃ³n de categorÃ­a actualiza reglas y ejemplos sin intervenciÃ³n manual
- ğŸš€ **Latencia mÃ­nima**: RecuperaciÃ³n de ejemplos <50ms, sin impacto en experiencia de usuario

### v3.7.0 (2026-02-19) - Auto-Embeddings System ğŸ¤–

- ğŸ”„ **Embeddings AutomÃ¡ticos**: Sistema de generaciÃ³n automÃ¡tica de embeddings cada 5 gastos (global, todos los usuarios)
- âš¡ **BÃºsqueda SemÃ¡ntica**: El agente aprende automÃ¡ticamente de los gastos sin intervenciÃ³n manual
- ğŸš€ **Procesamiento en Batch**: Hasta 50 gastos procesados en paralelo (~2.75 gastos/segundo)
- ğŸ’° **Ultra-EconÃ³mico**: ~$0.000005 por cada 12 gastos procesados
- ğŸ” **Transparente**: Sistema completamente automÃ¡tico, invisible para el usuario

### v3.6.2 (2026-02-19) - Mobile Navigation Global Fix ğŸŒ

- ğŸ“± **Global Mobile Menu**: Implementado menÃº hamburguesa en todas las pÃ¡ginas pÃºblicas (Landing, Blog, Herramientas). Ahora la navegaciÃ³n es consistente en toda la web.

### v3.6.1 (2026-02-19) - Mobile Fixes ğŸ“±

- ğŸ› **Mobile Nav**: CorrecciÃ³n de visualizaciÃ³n en menÃº superior mÃ³vil. Ocultados enlaces de escritorio para evitar saturaciÃ³n.

### v3.6.0 (2026-02-18) - Global Expansion ğŸŒ

**Internationalization:**
- ğŸ‡ªğŸ‡¸/ğŸ‡¬ğŸ‡§ **Soporte BilingÃ¼e**: Kakebo ahora habla EspaÃ±ol e InglÃ©s nativo. Nuevo switcher tipo toggle visual.
- ğŸ—ºï¸ **SEO Internacional**: Etiquetas `hreflang` y metadatos optimizados para cada idioma.
- ğŸ“ **Rutas Localizadas**: NavegaciÃ³n amigable `/es` y `/en` para mejor indexaciÃ³n.
- âš–ï¸ **Legal**: PÃ¡ginas de Privacidad, Cookies y TÃ©rminos totalmente traducidas y adaptadas.

**Mejoras:**
- ğŸ”§ **Tools Refactor**: Calculadoras (InflaciÃ³n, 50/30/20) reescritas para ser "Client Components" mÃ¡s rÃ¡pidos y estables.
- ğŸ› **Build Fixes**: ResoluciÃ³n de conflictos de tipos en webhooks de Stripe y configuraciÃ³n de Next.js.

### v3.2.0 (2026-02-16) - Branding & Polish ğŸ’…

**Novedades:**
- ğŸ·ï¸ **Rebranding**: UnificaciÃ³n de marca a **"Kakebo"**. Despliegue de nueva identidad en Landing y App.
- ğŸ’° **CorrecciÃ³n Financiera**: Fix crÃ­tico en cÃ¡lculo de ingresos (Base + Extras) y visualizaciÃ³n de dÃ©ficit.
- ğŸ”— **Dominios**: Fix en redirecciones (Stripe/Auth) para soportar dominios personalizados.

- ğŸŒ— **UI**: Mejoras de contraste en Modo Oscuro y accesibilidad en calendarios.

### v3.5.0 (2026-02-17) - Security Hardening ğŸ›¡ï¸

**Mejoras de Seguridad:**
- ğŸ”’ **Security Headers**: ImplementaciÃ³n estricta de HSTS, CSP y X-Frame-Options para prevenir XSS y Clickjacking.
- ğŸš¦ **Rate Limiting**: ProtecciÃ³n bÃ¡sica contra ataques DoS/fuerza bruta en la API.
- ğŸ›¡ï¸ **Middleware Blindado**: RedirecciÃ³n forzada para usuarios no autenticados en rutas protegidas.
- ğŸ’¾ **RLS Audit**: Endurecimiento de polÃ­ticas de base de datos (Supabase) para garantizar la privacidad de los datos.

### v3.4.0 (2026-02-17) - SEO & Social Proof ğŸŒŸ

**Novedades:**
- ğŸ” **SEO Aggressive**: OptimizaciÃ³n de keywords de alto valor ("Sin bancos", "Gastos hormiga", "Alternativa a Excel").
- ğŸŒŸ **Testimonios**: Nueva secciÃ³n de prueba social con historias de usuarios reales.
- ğŸ§² **CRO Tools**: Nuevo Simulador de Ahorro y Tabla Comparativa (Kakebo vs Excel vs Bancos).
- ğŸª **Legal**: Banner de Cookies (GDPR) y pÃ¡ginas legales actualizadas.
- ğŸ§² **Calculadora 50/30/20**: CorrecciÃ³n de enlaces y mejora de metadata para captaciÃ³n.
- ğŸ·ï¸ **Metadatos**: TÃ­tulos y descripciones optimizados para CTR.

### v3.3.0 (2026-02-16) - SEO & Growth ğŸš€

**Novedades:**
- ğŸ§² **Link Magnets**: Nuevas calculadoras pÃºblicas (InflaciÃ³n & 50/30/20) optimizadas para SEO/GEO.
- ğŸ“Š **Analytics**: Tracking de uso de herramientas respetuoso con la privacidad.
- ğŸš¦ **Performance**: Mejora de Core Web Vitals (Fuentes & ImÃ¡genes).

### v3.1.0 (2026-02-13) - Experience Upgrade ğŸ¨

- ğŸ’¬ **Floating Chat**: Nuevo widget flotante para acceso rÃ¡pido al Copilot.
- âš¡ **Performance**: Transiciones suaves y optimizaciÃ³n de carga.
- ğŸ“± **Mobile**: Fixes de scroll y teclado virtual.

**Ver changelog completo**: [CHANGELOG.md](CHANGELOG.md)

---

## ğŸ“œ Licencia

**Proprietary** - Todos los derechos reservados
Â© 2026 Kakebo. Este software es propiedad privada.

---

<div align="center">

**Hecho con â¤ï¸ y ğŸ¤– AI**
Desarrollado por: [Aitor AlarcÃ³n MuÃ±oz](mailto:aitoralmu21@gmail.com)

[â¬† Volver arriba](#-kakebo)

</div>
